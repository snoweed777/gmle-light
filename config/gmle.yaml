anki:
  card_template:
    back: null
    css: ''
    front: null
  deck_bank_prefix: 'GMLE::Bank::'
  note_type_name: GMLE_MCQA
api:
  anki:
    # Docker内からホストMacのAnkiConnectに接続
    connect_url: http://host.docker.internal:8765
    connect_version: 6
  generation:
    microservice:
      enabled: false
      url: http://localhost:8001
  ingest:
    microservice:
      enabled: false
      url: http://localhost:8002
  readwise:
    api_url: https://readwise.io/api/v2/highlights/
http:
  max_retries: 3
  retry_backoff_base: 2
  timeout: 30
ingest:
  excerpt_max: 800
  excerpt_min: 200
  quarantine_min_length: 200
llm:
  active_provider: groq
  providers:
    cohere:
      api_url: https://api.cohere.ai/v1/chat
      available_models:
      - command-a-03-2025
      - command-r-plus
      default_model: command-a-03-2025
    gemini:
      api_url: https://generativelanguage.googleapis.com/v1beta
      available_models:
      - gemini-2.5-flash
      - gemini-2.5-pro
      - gemini-2.0-flash
      - gemini-1.5-pro
      - gemini-1.5-flash
      default_model: gemini-2.5-flash
    groq:
      api_url: https://api.groq.com/openai/v1
      available_models:
      - llama-3.1-8b-instant
      - llama-3.3-70b-versatile
      - mixtral-8x7b-32768
      - gemma-7b-it
      - gemma2-9b-it
      default_model: llama-3.1-8b-instant  # より軽量で高速
lock:
  stale_seconds: 3600
logging:
  file: null
  format: human
  level: INFO
  rotation_days: 30
params:
  coverage: 6
  domain_cap_steps:
  - 6
  - 7
  - 8
  - 9999
  excerpt_max: 800
  excerpt_min: 200
  improve: 7
  maintain_total: 20
  new_total: 10
  rationale_quote_max: 100
  reward_cap: 3
  total: 30
prompts:
  stage1_extract:
    description: 'Stage 1: 事実抽出プロンプト'
    template: "以下のテキストから重要な事実を抽出してください。\n各事実には、元のテキストからの引用（support_quote）を必ず含めてください。\n\
      \n【テキスト】\n{excerpt}\n\n【出力形式】\nJSONフォーマットで返してください：\n{{\n  \"facts\": [\n   \
      \ {{\"id\": \"f1\", \"text\": \"事実の内容\", \"support_quote\": \"元のテキストからの引用\"\
      }}\n  ]\n}}\n"
  stage2_build_mcq:
    description: 'Stage 2: MCQ生成プロンプト'
    template: "以下の事実から多肢選択問題（MCQ）を作成してください。\n\n【事実】\n{facts}\n\n【出力形式】\nJSONフォーマットで返してください：\n\
      {{\n  \"question\": \"問題文\",\n  \"choices\": [\"A: 選択肢1\", \"B: 選択肢2\", \"C:\
      \ 選択肢3\", \"D: 選択肢4\"],\n  \"answer\": \"A\",\n  \"rationale\": {{\n    \"text\"\
      : \"解説文\",\n    \"quote\": \"元のテキストからの引用（100文字以内）\"\n  }}\n}}\n"
rate_limit:
  burst_limit: 1  # 1秒間に最大1回（requests_per_second=0.017と整合性を取る）
  call_type_limits:
    api_key_check:
      requests_per_day: 50
      requests_per_hour: 100
      requests_per_minute: 60
    mcq_generation:
      requests_per_day: 360  # Groq無料枠: 月間14,400 / 30日 = 480、安全マージン25%で360
      requests_per_hour: 15  # 安全マージン25%で15
      requests_per_minute: 1  # 約1分に1回（維持）
    prerequisite_check:
      requests_per_day: 50
      requests_per_hour: 100
      requests_per_minute: 60
  concurrent_requests: 3
  cooldown_seconds: 60
  enabled: true
  provider_daily_limits:
    cohere: 900
    gemini: 1400
    groq: 360  # 安全マージン25%（月間10,800回使用、3,600回の余裕）
  requests_per_day: 360  # Groq無料枠: 月間14,400 / 30日 = 480、安全マージン25%で360
  requests_per_hour: 15  # 安全マージン25%で15
  requests_per_minute: 1  # 約1分に1回（維持）
  requests_per_second: 0.014  # 約71秒に1回（より保守的）
version: '1.0'
